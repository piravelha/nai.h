#define NAI_FLAGS "-I../../"
#include "nai.h"

typedef struct {
    float x, y;
} Point;

#define POINT_FMT "(%.2f, %.2f)"
#define POINT_ARG(p) p.x, p.y

#define POINT NM(POINT, Point)

typedef struct {
    const char *name;
    int age;
    Point point;
} Person;

#define PERSON_FMT "{.name = %s, .age = %d, .point = "POINT_FMT"}"
#define PERSON_ARG(p) p.name, p.age, POINT_ARG(p.point)

#define PERSON NM(PERSON, Person)

#define NM_FORMATS POINT PERSON
#include "nm.h"


int main(int argc, char **argv)
{
    REBUILD(argc, argv);

    Person person = {
        .name = "Bit",
        .age = 16,
        .point = {1, 2},
    };

    Point point = {
        .x = -0.5, .y = 0.5,
    };

    println_many({PERSON person},
                 {S "\n"},
                 {POINT point});

    return 0;
}





